<ng-container *ngIf="userCertifications$ | async as data">
    <div class="table-container">
        <ng-container *ngIf="data && data.length > 0; else emptyState">
            <p-table
                [value]="data"
                styleClass="certification-table"
                [scrollable]="true"
                [tableStyle]="{ width: '100%' }"
                [rows]="50"
                [rowsPerPageOptions]="[50, 100, 200]"
                [paginator]="true"
                [showCurrentPageReport]="true"
                currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
            >
                <ng-template pTemplate="header">
                    <tr>
                        <th>Type</th>
                        <th>Valid From Date</th>
                        <th>Expiry Date</th>
                        <th>Document</th>
                        <th
                            alignFrozen="right"
                            pFrozenColumn
                            [appPermission]="{
                                features: [{
                                    feature: features.userManagementEdit.name,
                                    page: features.userManagementEdit.pages
                                        .certifications.name,
                                    pageFeature: [
                                        features.userManagementEdit.pages
                                            .certifications.features
                                            .certificationUpdate.name,
                                        features.userManagementEdit.pages
                                            .certifications.features
                                            .certificationDelete.name
                                    ],
                                    pageFeatureCheck: 'or',
                                }],
                                mode: 'none'
                            }"
                        >
                            Action
                        </th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-item>
                    <tr>
                        <td>{{ item.displayName }}</td>
                        <td>{{ item.fromDate | date : 'MM/dd/yyyy' }}</td>
                        <td>
                            <ng-container
                                *ngIf="item.isNeverExpire; else noExpireDate"
                            >
                                Does Not Expire
                            </ng-container>
                            <ng-template #noExpireDate>
                                {{ item.expireDate | date : 'MM/dd/yyyy' }}
                            </ng-template>
                        </td>
                        <td class="document-container">
                            <ng-container
                                *ngIf="item.documentPath; else noDocument"
                            >
                                <div class="link-container">
                                    <div class="text-container">
                                        <a
                                            [href]="item.documentPath"
                                            target="_blank"
                                        >
                                            {{
                                                item.documentPath
                                                    .split('\/')
                                                    .pop()
                                            }}
                                        </a>
                                    </div>
                                    <i class="pi pi-external-link"></i>
                                </div>
                            </ng-container>
                            <ng-template #noDocument>
                                <span>No Document Uploaded</span>
                            </ng-template>
                        </td>

                        <td
                            alignFrozen="right"
                            pFrozenColumn
                            class="action-column"
                            [appPermission]="{
                                features: [{
                                    feature: features.userManagementEdit.name,
                                    page: features.userManagementEdit.pages
                                        .certifications.name,
                                    pageFeature: [
                                        features.userManagementEdit.pages
                                            .certifications.features
                                            .certificationUpdate.name,
                                        features.userManagementEdit.pages
                                            .certifications.features
                                            .certificationDelete.name
                                    ],
                                    pageFeatureCheck: 'or',
                                }],
                                mode: 'none'
                            }"
                        >
                            <button
                                pButton
                                class="p-button-text edit"
                                icon="pi pi-pencil"
                                (click)="openEditCertificationModal(item)"
                                tooltipPosition="left"
                                pTooltip="Edit"
                                [appPermission]="{
                                    features: [{
                                        feature: features.userManagementEdit.name,
                                        page: features.userManagementEdit.pages
                                            .certifications.name,
                                        pageFeature: [
                                            features.userManagementEdit.pages
                                                .certifications.features
                                                .certificationUpdate.name
                                        ],
                                        pageFeatureCheck: 'or',
                                    }],
                                    mode: 'none'
                                }"
                            ></button>
                            <button
                                pButton
                                icon="pi pi-trash"
                                class="p-button-text delete"
                                tooltipPosition="left"
                                pTooltip="Delete"
                                (click)="openRemoveCertificationModal(item)"
                                [appPermission]="{
                                    features:[{
                                        feature: features.userManagementEdit.name,
                                        page: features.userManagementEdit.pages
                                            .certifications.name,
                                        pageFeature: [
                                            features.userManagementEdit.pages
                                                .certifications.features
                                                .certificationDelete.name
                                        ],
                                        pageFeatureCheck: 'or',
                                    }],
                                    mode: 'none'
                                }"
                            ></button>
                        </td>
                    </tr>
                </ng-template>
            </p-table>
        </ng-container>
        <ng-template #emptyState>
            <div class="empty-state-container">
                <h3>No Available Certifications</h3>
            </div>
        </ng-template>
    </div>
</ng-container>
