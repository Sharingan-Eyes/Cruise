<ng-container
    *ngIf="{
        isOpen: (isOpen$ | async) || false,
        status: status$ | async,
        shipCompanyName: shipCompanyName$ | async,
        cruiseLineTourList: cruiseLineTourList$ | async,
    } as data"
>
    <p-dialog
        [(visible)]="data.isOpen"
        (onHide)="close()"
        [modal]="true"
        [style]="{ width: '60vw', height: 'auto' }"
        styleClass="cruise-line-tour-list-modal"
        [breakpoints]="{ '700px': '100vw' }"
        [showHeader]="false"
        [draggable]="false"
        [resizable]="false"
        [dismissableMask]="true"
        appendTo="body"
    >
        <div class="modal-inner-container">
            <div class="modal-header">
                <h2>Tours/Services offered by {{ data.shipCompanyName }}</h2>
            </div>
            <p-divider></p-divider>
            <div class="modal-body">
                <div class="content-header-container">
                    <h3>Tours/Services</h3>
                    <input
                        type="text"
                        autocomplete="off"
                        pInputText
                        placeholder="Search ..."
                        [(ngModel)]="keyword"
                        (ngModelChange)="search()"
                    />
                </div>
                <ng-container [ngSwitch]="data.status?.loadCruiseLineTourList">
                    <ng-container *ngSwitchCase="'loading'">
                        <app-loader-embed
                            [isDisplayed]="true"
                        ></app-loader-embed>
                    </ng-container>
                    <ng-container *ngSwitchCase="'error'">
                        <div class="error-state">
                            <span>Error loading Cruise Line Tour List</span>
                            <button pButton>Retry</button>
                        </div>
                    </ng-container>
                    <ng-container *ngSwitchCase="'success'">
                        <div class="table-container">
                            <p-table
                                #cruiseLineTourListTable
                                [value]="data.cruiseLineTourList || []"
                                [scrollable]="true"
                                [tableStyle]="{ width: '100%' }"
                                [rows]="20"
                                [rowsPerPageOptions]="[20, 50, 100]"
                                [paginator]="true"
                                [showCurrentPageReport]="true"
                                currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
                                [globalFilterFields]="[
                                    'cruiseLineTourName',
                                    'netRateAdult',
                                    'netRateChild'
                                ]"
                            >
                                <ng-template pTemplate="header">
                                    <tr>
                                        <th>Tour Name</th>
                                        <th>Cruise Line Tour Name</th>
                                        <th>Net Rate Adult</th>
                                        <th>Net Rate Child</th>
                                        <th>Is Offered</th>
                                        <th alignFrozen="right" pFrozenColumn>
                                            Action
                                        </th>
                                    </tr>
                                </ng-template>
                                <ng-template pTemplate="body" let-item>
                                    <tr>
                                        <td>{{ item.tourName }}</td>
                                        <td>
                                            {{ item.cruiseLineTourName }}
                                        </td>
                                        <td>{{ item.netRateAdult }}</td>
                                        <td>{{ item.netRateChild }}</td>
                                        <td>
                                            {{ item.isOffered }}
                                        </td>
                                        <td alignFrozen="right" pFrozenColumn>
                                            <div class="actions-container">
                                                <button
                                                    pButton
                                                    icon="pi pi-pencil"
                                                    class="p-button-text edit"
                                                    pTooltip="Edit"
                                                    tooltipPosition="left"
                                                    (click)="
                                                        openEditCruiseLineTourModal(
                                                            item
                                                        )
                                                    "
                                                ></button>
                                            </div>
                                        </td>
                                    </tr>
                                </ng-template>
                            </p-table>
                        </div>
                    </ng-container>
                </ng-container>
            </div>
        </div>
    </p-dialog>
</ng-container>
<!-- modals -->
<app-edit-cruise-line-tour-modal></app-edit-cruise-line-tour-modal>
